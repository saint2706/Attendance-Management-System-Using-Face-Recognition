{% extends "recognition/base.html" %}
{% load static %}

{% block title %}Attendance Dashboard - Smart Attendance System{% endblock %}

{% block content %}
<header class="d-flex justify-content-between align-items-center mb-6 flex-wrap" style="margin-bottom: var(--space-8); gap: var(--space-4);">
    <h1 style="font-size: var(--font-size-3xl); font-weight: var(--font-weight-bold); color: var(--color-text); margin: 0;">
        Attendance Dashboard
    </h1>
    <div class="d-flex gap-2 flex-wrap">
        <a href="{% url 'view-attendance-employee' %}" class="btn btn-outline-primary">
            <i class="fas fa-user" aria-hidden="true"></i> View by Employee
        </a>
        <a href="{% url 'view-attendance-date' %}" class="btn btn-outline-primary">
            <i class="fas fa-calendar" aria-hidden="true"></i> View by Date
        </a>
    </div>
</header>

<!-- Statistics Cards -->
<section aria-label="Attendance statistics" class="mb-8" style="margin-bottom: var(--space-10);">
    <div class="row">
        <div class="col-12 col-md-6 mb-4">
            <article class="card" style="background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%); color: var(--color-white); border: none;">
                <div class="card-body text-center" style="padding: var(--space-8);">
                    <i class="fas fa-users" style="font-size: 2.5rem; margin-bottom: var(--space-4); opacity: 0.9;" aria-hidden="true"></i>
                    <h2 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-medium); margin-bottom: var(--space-3); opacity: 0.95;">
                        Total Employees
                    </h2>
                    <p style="font-size: 3.5rem; font-weight: var(--font-weight-bold); margin: 0; line-height: 1;">
                        {{ total_num_of_emp }}
                    </p>
                </div>
            </article>
        </div>
        <div class="col-12 col-md-6 mb-4">
            <article class="card" style="background: linear-gradient(135deg, var(--color-success) 0%, #157347 100%); color: var(--color-white); border: none;">
                <div class="card-body text-center" style="padding: var(--space-8);">
                    <i class="fas fa-user-check" style="font-size: 2.5rem; margin-bottom: var(--space-4); opacity: 0.9;" aria-hidden="true"></i>
                    <h2 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-medium); margin-bottom: var(--space-3); opacity: 0.95;">
                        Employees Present Today
                    </h2>
                    <p style="font-size: 3.5rem; font-weight: var(--font-weight-bold); margin: 0; line-height: 1;">
                        {{ emp_present_today }}
                    </p>
                </div>
            </article>
        </div>
    </div>
</section>

<!-- Attendance Graphs -->
<section aria-label="Attendance trends">
    <h2 class="mb-6" style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-6);">
        Attendance Trends
    </h2>
    <div class="row">
        <div class="col-12 col-lg-6 mb-4">
            <article class="card">
                <div class="card-body" style="padding: var(--space-6);">
                    <h3 class="card-title text-center mb-4" style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--color-text);">
                        <i class="fas fa-chart-line" aria-hidden="true"></i> This Week's Attendance
                    </h3>
                    {% if this_week_graph_url %}
                        <div style="border-radius: var(--radius-md); overflow: hidden; background-color: var(--color-gray-50);">
                            <img src="{{ this_week_graph_url }}" class="img-fluid" alt="Graph showing this week's attendance trends" style="width: 100%; height: auto;">
                        </div>
                        <p class="text-center text-muted mt-3 mb-0" style="font-size: var(--font-size-sm);">
                            Number of employees present each day
                        </p>
                    {% else %}
                        <div class="text-center" style="padding: var(--space-10) var(--space-4); background-color: var(--color-gray-50); border-radius: var(--radius-md);">
                            <i class="fas fa-chart-line" style="font-size: 3rem; color: var(--color-text-muted); opacity: 0.3; margin-bottom: var(--space-4);" aria-hidden="true"></i>
                            <p class="text-muted mb-0" style="font-size: var(--font-size-base);">
                                Graphs will appear once attendance data is available.
                            </p>
                        </div>
                    {% endif %}
                </div>
            </article>
        </div>
        <div class="col-12 col-lg-6 mb-4">
            <article class="card">
                <div class="card-body" style="padding: var(--space-6);">
                    <h3 class="card-title text-center mb-4" style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--color-text);">
                        <i class="fas fa-chart-bar" aria-hidden="true"></i> Last Week's Attendance
                    </h3>
                    {% if last_week_graph_url %}
                        <div style="border-radius: var(--radius-md); overflow: hidden; background-color: var(--color-gray-50);">
                            <img src="{{ last_week_graph_url }}" class="img-fluid" alt="Graph showing last week's attendance trends" style="width: 100%; height: auto;">
                        </div>
                        <p class="text-center text-muted mt-3 mb-0" style="font-size: var(--font-size-sm);">
                            Number of employees present each day
                        </p>
                    {% else %}
                        <div class="text-center" style="padding: var(--space-10) var(--space-4); background-color: var(--color-gray-50); border-radius: var(--radius-md);">
                            <i class="fas fa-chart-bar" style="font-size: 3rem; color: var(--color-text-muted); opacity: 0.3; margin-bottom: var(--space-4);" aria-hidden="true"></i>
                            <p class="text-muted mb-0" style="font-size: var(--font-size-base);">
                                Graphs will appear once attendance data is available.
                            </p>
                        </div>
                    {% endif %}
                </div>
            </article>
        </div>
    </div>
</section>

<!-- Quick Info Card -->
<section class="mt-8" style="margin-top: var(--space-12);">
    <div class="card" style="border-left: 4px solid var(--color-info);">
        <div class="card-body" style="padding: var(--space-6);">
            <div class="d-flex align-items-start gap-4">
                <i class="fas fa-info-circle" style="font-size: 2rem; color: var(--color-info);" aria-hidden="true"></i>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); margin-bottom: var(--space-2); color: var(--color-text);">
                        About Attendance Reports
                    </h3>
                    <p class="text-muted mb-0" style="font-size: var(--font-size-base);">
                        The attendance dashboard provides real-time statistics and visualizations of employee attendance. 
                        Use the "View by Employee" button to see individual attendance records, or "View by Date" to see 
                        attendance for specific dates. All data can be exported to CSV format for further analysis.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}