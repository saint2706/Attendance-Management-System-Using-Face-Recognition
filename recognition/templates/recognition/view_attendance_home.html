{% extends "recognition/base.html" %}
{% load static %}

{% block title %}Attendance Dashboard - Smart Attendance System{% endblock %}

{% block content %}
<header class="u-dashboard-header">
    <h1 class="u-dashboard-title">
        Attendance Dashboard
    </h1>
    <div class="d-flex gap-2 flex-wrap">
        <a href="{% url 'view-attendance-employee' %}" class="btn btn-outline-primary">
            <i class="fas fa-user" aria-hidden="true"></i> View by Employee
        </a>
        <a href="{% url 'view-attendance-date' %}" class="btn btn-outline-primary">
            <i class="fas fa-calendar" aria-hidden="true"></i> View by Date
        </a>
    </div>
</header>

<!-- Statistics Cards -->
<section aria-labelledby="attendance-statistics" class="mb-10">
    <h2 id="attendance-statistics" class="u-section-title">
        Attendance Statistics
    </h2>
    <div class="row">
        <div class="col-12 col-md-6 mb-4">
            <article class="card card-hero card-hero--primary">
                <div class="card-body card-body-lg text-center">
                    <i class="fas fa-users icon-xl mb-4 opacity-90" aria-hidden="true"></i>
                    <h3 class="text-lg font-weight-medium mb-3 opacity-90">
                        Total Employees
                    </h3>
                    <p class="text-3xl font-weight-bold mb-0 leading-tight">
                        {{ total_num_of_emp }}
                    </p>
                </div>
            </article>
        </div>
        <div class="col-12 col-md-6 mb-4">
            <article class="card card-hero card-hero--success">
                <div class="card-body card-body-lg text-center">
                    <i class="fas fa-user-check icon-xl mb-4 opacity-90" aria-hidden="true"></i>
                    <h3 class="text-lg font-weight-medium mb-3 opacity-90">
                        Employees Present Today
                    </h3>
                    <p class="text-3xl font-weight-bold mb-0 leading-tight">
                        {{ emp_present_today }}
                    </p>
                </div>
            </article>
        </div>
    </div>
</section>

<!-- Attendance Graphs -->
<section aria-labelledby="attendance-trends">
    <h2 id="attendance-trends" class="u-section-title mb-6">
        Attendance Trends
    </h2>
    <div class="row">
        <div class="col-12 col-lg-6 mb-4">
            <article class="card">
                <div class="card-body card-body-lg">
                    <h3 class="text-xl font-weight-semibold text-center mb-4">
                        <i class="fas fa-chart-line" aria-hidden="true"></i> This Week's Attendance
                    </h3>
                    {% if this_week_graph_url %}
                        <div class="card-media">
                            <img
                                src="{{ this_week_graph_url }}"
                                class="img-fluid chart-image"
                                alt="Graph showing this week's attendance trends"
                                loading="lazy"
                                decoding="async"
                                width="640"
                                height="480"
                            >
                        </div>
                        <p class="text-center text-muted text-sm mt-3 mb-0">
                            Number of employees present each day
                        </p>
                    {% else %}
                        <div class="card-empty">
                            <i class="fas fa-chart-line icon-xxl text-muted icon-soft mb-4" aria-hidden="true"></i>
                            <p class="text-muted text-base mb-0">
                                Graphs will appear once attendance data is available.
                            </p>
                        </div>
                    {% endif %}
                </div>
            </article>
        </div>
        <div class="col-12 col-lg-6 mb-4">
            <article class="card">
                <div class="card-body card-body-lg">
                    <h3 class="text-xl font-weight-semibold text-center mb-4">
                        <i class="fas fa-chart-bar" aria-hidden="true"></i> Last Week's Attendance
                    </h3>
                    {% if last_week_graph_url %}
                        <div class="card-media">
                            <img
                                src="{{ last_week_graph_url }}"
                                class="img-fluid chart-image"
                                alt="Graph showing last week's attendance trends"
                                loading="lazy"
                                decoding="async"
                                width="640"
                                height="480"
                            >
                        </div>
                        <p class="text-center text-muted text-sm mt-3 mb-0">
                            Number of employees present each day
                        </p>
                    {% else %}
                        <div class="card-empty">
                            <i class="fas fa-chart-bar icon-xxl text-muted icon-soft mb-4" aria-hidden="true"></i>
                            <p class="text-muted text-base mb-0">
                                Graphs will appear once attendance data is available.
                            </p>
                        </div>
                    {% endif %}
                </div>
            </article>
        </div>
    </div>
</section>

<!-- Quick Info Card -->
<section class="u-section" aria-labelledby="attendance-reports-info">
    <div class="card card-accent card-accent--info">
        <div class="card-body card-body-lg">
            <div class="d-flex align-items-start gap-4">
                <i class="fas fa-info-circle icon-lg text-info" aria-hidden="true"></i>
                <div>
                    <h3 id="attendance-reports-info" class="text-lg font-weight-semibold mb-2">
                        About Attendance Reports
                    </h3>
                    <p class="text-muted text-base mb-0">
                        The attendance dashboard provides real-time statistics and visualizations of employee attendance.
                        Use the "View by Employee" button to see individual attendance records, or "View by Date" to see
                        attendance for specific dates. All data can be exported to CSV format for further analysis.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}